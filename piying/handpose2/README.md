# Handpose Demo — 摄像头手势控制人偶双手与头部

该 demo 调用摄像头并识别手部关键点（MediaPipe Hands），将拇指/小指/中指分别映射到人偶的右手/左手/头部的旋转角度；当检测到手部快速甩动时，对人偶进行水平翻转。此 demo 不改动任何现有文件。

## 安装依赖

```
pip install -r handpose/requirements.txt
```

## 运行

```
python handpose/demo.py
```

## 功能说明

- 摄像头：使用默认摄像头（设备 0），在窗口左侧展示画面；右侧显示人偶骨骼。
- 手势映射：
  - 拇指角度 → 控制右手（`right_lower_arm`）相对于上臂的旋转。
  - 小指角度 → 控制左手（`left_lower_arm`）相对于上臂的旋转。
  - 中指角度 → 控制头部（`head`）相对于身体的旋转。
- 快速甩动：当检测到手腕在水平轴上的速度超过阈值（并有短暂冷却时间）时，触发人偶的水平翻转（左右镜像）。
- 键位：
  - `Esc` 退出
  - `R` 重置姿态

## 原理简述

- 使用 MediaPipe Hands 获取手部关键点，取每根手指的 MCP→TIP 向量，计算与屏幕竖直方向的夹角作为角度输入。
- 将手指角度作为目标“全局角度”，通过减去父关节的全局角度得到局部旋转，直接赋值到对应骨骼部件。
- 水平翻转通过在绘制阶段对 X 坐标相对人偶中心点进行镜像实现，不修改骨骼数据结构。

## 注意事项

- 若未安装依赖，demo 会友好提示并退出，不影响项目其他部分。
- 在多手检测情况下，默认取首个检测到的手进行控制；可按需扩展为双手分别控制。